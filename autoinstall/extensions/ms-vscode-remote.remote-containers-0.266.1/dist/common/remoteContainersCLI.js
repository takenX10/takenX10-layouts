/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------------------------------------------*/

var h=Object.create;var i=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var d=e=>i(e,"__esModule",{value:!0});var P=(e,n)=>{d(e);for(var t in n)i(e,t,{get:n[t],enumerable:!0})},v=(e,n,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of C(n))!E.call(e,r)&&r!=="default"&&i(e,r,{get:()=>n[r],enumerable:!(t=m(n,r))||t.enumerable});return e},O=e=>v(d(i(e!=null?h(x(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);P(exports,{getCredential:()=>f});var p=O(require("http")),a=process.env.REMOTE_CONTAINERS_IPC;function f(e){let n={get:"fill",store:"approve",erase:"reject"}[e];if(n===void 0){console.log("Expected get, store or erase.");return}let t="";process.stdin.setEncoding("utf8"),process.stdin.on("data",r=>{t+=r,(t===`
`||t.indexOf(`

`,t.length-2)!==-1)&&(process.stdin.pause(),u(n,t).catch(console.error))}),process.stdin.on("end",()=>{u(n,t).catch(console.error)})}async function u(e,n){let t=await j({command:e,stdin:n});t||process.exit(-1);let{stdout:r,stderr:s,code:o}=JSON.parse(t);r&&process.stdout.write(r),s&&process.stderr.write(s),o&&process.exit(o)}function j(e){return new Promise(n=>{let t=JSON.stringify(e);if(!a){console.error("Dev Containers CLI: RPC pipe not configured. Message: "+t),n(void 0);return}let s=p.request({socketPath:a,path:"/",method:"POST"},o=>{let c=[];o.setEncoding("utf8"),o.on("data",l=>{c.push(l)}),o.on("error",()=>g("Error in response")),o.on("end",()=>{n(c.join(""))})});s.on("error",()=>g("Error in request")),s.write(t),s.end()})}function g(e){console.error("Unable to connect to VS Code Dev Containers extension."),console.error(e),process.exit(1)}f(process.argv[2]);0&&(module.exports={getCredential});
//# sourceMappingURL=remoteContainersCLI.js.map
