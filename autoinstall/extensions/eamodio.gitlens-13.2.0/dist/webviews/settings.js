(()=>{"use strict";var Lt={};class Y{constructor(e,t=!1){this.method=e,this.overwriteable=t}}class $ extends Y{}class M extends Y{}function N(i,e,t){i.method===e.method&&t(e.params,i)}const _e=new $("webview/ready"),Se=new $("webview/focus"),Dt=new $("command/execute"),Pe=new $("configuration/preview"),we=new $("configuration/update"),G=new M("configuration/didChange"),Te=new M("configuration/didPreview"),J=new M("webview/didOpenAnchor"),Q=/(?<literal>\[.*?\])|(?<year>YYYY|YY)|(?<month>M{1,4})|(?<day>Do|DD?)|(?<weekday>d{2,4})|(?<hour>HH?|hh?)|(?<minute>mm?)|(?<second>ss?)|(?<fractionalSecond>SSS)|(?<dayPeriod>A|a)|(?<timeZoneName>ZZ?)/g,Z=/(?<dateStyle>full|long|medium|short)(?:\+(?<timeStyle>full|long|medium|short))?/,$e=null;let w;const x=new Map;let _,T,S;function xe(i){typeof i=="string"?i==="system"?_=void 0:_=[i]:_=i??void 0,T=void 0,S=void 0,x.clear(),w=void 0}function Mt(i,e){const t=new Date(i.getTime());for(const[n,o]of Object.entries(e))if(o)switch(n){case"years":t.setFullYear(t.getFullYear()+o);break;case"months":t.setMonth(t.getMonth()+o);break;case"days":t.setDate(t.getDate()+o);break;case"hours":t.setHours(t.getHours()+o);break;case"minutes":t.setMinutes(t.getMinutes()+o);break;case"seconds":t.setSeconds(t.getSeconds()+o);break}return t}function Nt(i,e){const t=(typeof i=="number"?i:i.getTime())-new Date().getTime();for(const[n,o,a,s]of $e){const l=Math.abs(t);if(l>=o||o===1e3)return e?(w==null&&(S!=null?w=S.resolvedOptions().locale:T!=null?w=T.resolvedOptions().locale:(S=new Intl.RelativeTimeFormat(_,{localeMatcher:"best fit",numeric:"always",style:"narrow"}),w=S.resolvedOptions().locale)),w==="en"||w?.startsWith("en-")?`${Math.round(l/a)}${s}`:(S==null&&(S=new Intl.RelativeTimeFormat(_,{localeMatcher:"best fit",numeric:"always",style:"narrow"})),S.format(Math.round(t/a),n))):(T==null&&(T=new Intl.RelativeTimeFormat(_,{localeMatcher:"best fit",numeric:"auto",style:"long"})),T.format(Math.round(t/a),n))}return""}function K(i,e,t,n=!0){e=e??void 0;const o=`${t??""}:${e}`;let a=x.get(o);if(a==null){const r=Ce(e);let c;t==null?c=_:t==="system"?c=void 0:c=[t],a=new Intl.DateTimeFormat(c,r),n&&x.set(o,a)}if(e==null||Z.test(e))return a.format(i);function s(r){const c=`${t??""}:time:${r}`;let u=x.get(c);if(u==null){const h={localeMatcher:"best fit",timeStyle:r};let y;t==null?y=_:t==="system"?y=void 0:y=[t],u=new Intl.DateTimeFormat(y,h),n&&x.set(c,u)}return u}const l=a.formatToParts(i);return e.replace(Q,(r,c,u,h,y,L,me,ye,z,V,H,be,ve,D,f)=>{if(c!=null)return c.substring(1,c.length-1);for(const v in f){const k=f[v];if(k==null)continue;const P=l.find(ke=>ke.type===v);return k==="Do"&&P?.type==="day"?Ie(Number(P.value)):k==="a"&&P?.type==="dayPeriod"?` ${(s("short").formatToParts(i).find(At=>At.type==="dayPeriod")??P)?.value??""}`:P?.value??""}return""})}function Ft(i,e,t){const n=(typeof e=="number"?e:e.getTime())-(typeof i=="number"?i:i.getTime());switch(t){case"days":return Math.floor(n/(1e3*60*60*24));case"hours":return Math.floor(n/(1e3*60*60));case"minutes":return Math.floor(n/(1e3*60));case"seconds":return Math.floor(n/1e3);default:return n}}function Ce(i){if(i==null)return{localeMatcher:"best fit",dateStyle:"full",timeStyle:"short"};const e=Z.exec(i);if(e?.groups!=null){const{dateStyle:n,timeStyle:o}=e.groups;return{localeMatcher:"best fit",dateStyle:n||"full",timeStyle:o||void 0}}const t={localeMatcher:"best fit"};for(const{groups:n}of i.matchAll(Q))if(n!=null)for(const o in n){const a=n[o];if(a!=null)switch(o){case"year":t.year=a.length===4?"numeric":"2-digit";break;case"month":switch(a.length){case 4:t.month="long";break;case 3:t.month="short";break;case 2:t.month="2-digit";break;case 1:t.month="numeric";break}break;case"day":a==="DD"?t.day="2-digit":t.day="numeric";break;case"weekday":switch(a.length){case 4:t.weekday="long";break;case 3:t.weekday="short";break;case 2:t.weekday="narrow";break}break;case"hour":t.hour=a.length===2?"2-digit":"numeric",t.hour12=a==="hh"||a==="h";break;case"minute":t.minute=a.length===2?"2-digit":"numeric";break;case"second":t.second=a.length===2?"2-digit":"numeric";break;case"fractionalSecond":t.fractionalSecondDigits=3;break;case"dayPeriod":t.dayPeriod="narrow",t.hour12=!0,t.hourCycle="h12";break;case"timeZoneName":t.timeZoneName=a.length===2?"long":"short";break}}return t}const F=["th","st","nd","rd"];function Ie(i){const e=i%100;return`${i}${F[(e-20)%10]??F[e]??F[0]}`}function Ve(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}const q=Ve;var Be=typeof global=="object"&&global&&global.Object===Object&&global;const je=Be;var Oe=typeof self=="object"&&self&&self.Object===Object&&self,Ee=je||Oe||Function("return this")();const X=Ee;var Ae=function(){return X.Date.now()};const U=Ae;var Le=/\s/;function De(i){for(var e=i.length;e--&&Le.test(i.charAt(e)););return e}const Me=De;var Ne=/^\s+/;function Fe(i){return i&&i.slice(0,Me(i)+1).replace(Ne,"")}const qe=Fe;var Ue=X.Symbol;const B=Ue;var ee=Object.prototype,Re=ee.hasOwnProperty,We=ee.toString,C=B?B.toStringTag:void 0;function ze(i){var e=Re.call(i,C),t=i[C];try{i[C]=void 0;var n=!0}catch{}var o=We.call(i);return n&&(e?i[C]=t:delete i[C]),o}const He=ze;var Ye=Object.prototype,Ge=Ye.toString;function Je(i){return Ge.call(i)}const Qe=Je;var Ze="[object Null]",Ke="[object Undefined]",te=B?B.toStringTag:void 0;function Xe(i){return i==null?i===void 0?Ke:Ze:te&&te in Object(i)?He(i):Qe(i)}const et=Xe;function tt(i){return i!=null&&typeof i=="object"}const nt=tt;var ot="[object Symbol]";function it(i){return typeof i=="symbol"||nt(i)&&et(i)==ot}const st=it;var ne=0/0,rt=/^[-+]0x[0-9a-f]+$/i,at=/^0b[01]+$/i,lt=/^0o[0-7]+$/i,ct=parseInt;function ut(i){if(typeof i=="number")return i;if(st(i))return ne;if(q(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=q(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=qe(i);var t=at.test(i);return t||lt.test(i)?ct(i.slice(2),t?2:8):rt.test(i)?ne:+i}const oe=ut;var dt="Expected a function",ft=Math.max,pt=Math.min;function gt(i,e,t){var n,o,a,s,l,r,c=0,u=!1,h=!1,y=!0;if(typeof i!="function")throw new TypeError(dt);e=oe(e)||0,q(t)&&(u=!!t.leading,h="maxWait"in t,a=h?ft(oe(t.maxWait)||0,e):a,y="trailing"in t?!!t.trailing:y);function L(f){var v=n,k=o;return n=o=void 0,c=f,s=i.apply(k,v),s}function me(f){return c=f,l=setTimeout(V,e),u?L(f):s}function ye(f){var v=f-r,k=f-c,P=e-v;return h?pt(P,a-k):P}function z(f){var v=f-r,k=f-c;return r===void 0||v>=e||v<0||h&&k>=a}function V(){var f=U();if(z(f))return H(f);l=setTimeout(V,ye(f))}function H(f){return l=void 0,y&&n?L(f):(n=o=void 0,s)}function be(){l!==void 0&&clearTimeout(l),c=0,n=r=o=l=void 0}function ve(){return l===void 0?s:H(U())}function D(){var f=U(),v=z(f);if(n=arguments,o=this,r=f,v){if(l===void 0)return me(r);if(h)return clearTimeout(l),l=setTimeout(V,e),L(r)}return l===void 0&&(l=setTimeout(V,e)),s}return D.cancel=be,D.flush=ve,D}const ie=gt;function ht(i,e,t){const{track:n,...o}={track:!1,...t??{}};if(n!==!0)return ie(i,e,o);let a=!1;const s=ie(function(...r){return a=!1,i.apply(this,r)},e,t),l=function(...r){return a=!0,s.apply(this,r)};return l.pending=function(){return a},l.cancel=function(){return s.cancel.apply(s)},l.flush=function(){return s.flush.apply(s)},l}const mt=",",se="",yt="=",bt="{",vt="(",kt=")",_t=/\(([\s\S]*)\)/,St=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,Pt=/\s?=.*$/;function qt(i){if(typeof i!="function")throw new Error("Not supported");if(i.length===0)return[];let e=Function.prototype.toString.call(i);e=e.replace(St,se)||e,e=e.slice(0,e.indexOf(bt));let t=e.indexOf(vt),n=e.indexOf(kt);t=t>=0?t+1:0,n=n>0?n:e.indexOf(yt),e=e.slice(t,n),e=`(${e})`;const o=_t.exec(e);return o!=null?o[1].split(mt).map(a=>a.trim().replace(Pt,se)):[]}function Ut(i,e,t){return e==null?i!=null:typeof e=="function"?e(i):t===void 0?i[e]!==void 0:i[e]===t}function Rt(i){return _once(i)}function Wt(i,e){const t=(n,o)=>{const a=t.value===void 0?o:`${t.value}.${o}`;return t.value=a,Object.assign(l=>t(n[o],l),{value:a})};return t(i,e)}function zt(i,e){let t;const n={dispose:()=>{t!=null&&(clearInterval(t),t=void 0)}};return t=setInterval(i,e),n}async function Ht(i,e,t){for(const n of e)try{await i.apply(t,n)}catch{}}function Yt(i,e){return i>=e?i*i+i+e:i+e*e}async function Gt(i){await new Promise(e=>setTimeout(e,i))}var p;(i=>{function e(o,a,s,l){let r=!1;if(typeof o=="string"){const u=function(h){const y=h?.target?.closest(o);y!=null&&s(h,y)};return document.addEventListener(a,u,l??!0),{dispose:()=>{r||(r=!0,document.removeEventListener(a,u,l??!0))}}}const c=function(u){s(u,this)};return o.addEventListener(a,c,l??!1),{dispose:()=>{r||(r=!0,o.removeEventListener(a,c,l??!1))}}}i.on=e;function t(o,a,s){const l=document.getElementById(o);if(a.replaceChildren(l?.content.cloneNode(!0)),a.className=l.className,s?.visible!=null){const r=a.querySelectorAll("[data-visible]");for(const c of r){const u=c.dataset.visible;u&&(s.visible[u]?c.style.display="initial":c.style.display="none")}}if(s?.bindings!=null){const r=a.querySelectorAll("[data-bind]");for(const c of r){const u=c.dataset.bind;if(!u)continue;const h=s.bindings[u];h!=null&&(c.textContent=String(h))}}}i.insertTemplate=t;function n(o){o.replaceChildren(),o.className=""}i.resetSlot=n})(p||(p={}));const wt=/^(?:(#?)([0-9a-f]{3}|[0-9a-f]{6})|((?:rgb|hsl)a?)\((-?\d+%?)[,\s]+(-?\d+%?)[,\s]+(-?\d+%?)[,\s]*(-?[\d.]+%?)?\))$/i;function R(i,e){const t=i+e,n=e<0?t<0?0:t:t>255?255:t;return Math.round(n)}function g(i,e){return m(i,-e)}function m(i,e){const t=O(i);if(t==null)return i;const[n,o,a,s]=t,l=255*e/100;return`rgba(${R(n,l)}, ${R(o,l)}, ${R(a,l)}, ${s})`}function b(i,e){const t=O(i);if(t==null)return i;const[n,o,a,s]=t;return`rgba(${n}, ${o}, ${a}, ${s*(e/100)})`}function Jt(i,e,t){const n=O(i),o=O(e);if(n==null||o==null)return i;const[a,s,l,r]=n,[c,u,h,y]=o;return`rgba(${j(a,c,t)}, ${j(s,u,t)}, ${j(l,h,t)}, ${j(r,y,t)})`}const j=(i,e,t)=>i+(e-i)*t/100;function O(i){i=i.trim();const e=wt.exec(i);if(e==null)return null;if(e[1]==="#"){const t=e[2];switch(t.length){case 3:return[parseInt(t[0]+t[0],16),parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),1];case 6:return[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16),1]}return null}switch(e[3]){case"rgb":return[parseInt(e[4],10),parseInt(e[5],10),parseInt(e[6],10),1];case"rgba":return[parseInt(e[4],10),parseInt(e[5],10),parseInt(e[6],10),parseFloat(e[7])];default:return null}}const re=class{constructor(){this._disposed=!1}get event(){return this._event==null&&(this._event=(i,e,t)=>{this.listeners==null&&(this.listeners=new le);const n=this.listeners.push(e==null?i:[i,e]),o={dispose:()=>{o.dispose=re._noop,this._disposed||n()}};return Array.isArray(t)&&t.push(o),o}),this._event}fire(i){if(this.listeners!=null){this._deliveryQueue==null&&(this._deliveryQueue=new le);for(let e=this.listeners.iterator(),t=e.next();!t.done;t=e.next())this._deliveryQueue.push([t.value,i]);for(;this._deliveryQueue.size>0;){const[e,t]=this._deliveryQueue.shift();try{typeof e=="function"?e(t):e[0].call(e[1],t)}catch{}}}}dispose(){this.listeners?.clear(),this._deliveryQueue?.clear(),this._disposed=!0}};let ae=re;ae._noop=function(){};const Tt={done:!0,value:void 0},E=class{constructor(i){this.element=i,this.next=E.Undefined,this.prev=E.Undefined}};let d=E;d.Undefined=new E(void 0);class le{constructor(){this._first=d.Undefined,this._last=d.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===d.Undefined}clear(){this._first=d.Undefined,this._last=d.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const n=new d(e);if(this._first===d.Undefined)this._first=n,this._last=n;else if(t){const a=this._last;this._last=n,n.prev=a,a.next=n}else{const a=this._first;this._first=n,n.next=a,a.prev=n}this._size+=1;let o=!1;return()=>{o||(o=!0,this._remove(n))}}shift(){if(this._first===d.Undefined)return;const e=this._first.element;return this._remove(this._first),e}pop(){if(this._last===d.Undefined)return;const e=this._last.element;return this._remove(this._last),e}_remove(e){if(e.prev!==d.Undefined&&e.next!==d.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===d.Undefined&&e.next===d.Undefined?(this._first=d.Undefined,this._last=d.Undefined):e.next===d.Undefined?(this._last=this._last.prev,this._last.next=d.Undefined):e.prev===d.Undefined&&(this._first=this._first.next,this._first.prev=d.Undefined);this._size-=1}iterator(){let e,t=this._first;return{next:function(){return t===d.Undefined?Tt:(e==null?e={done:!1,value:t.element}:e.value=t.element,t=t.next,e)}}}toArray(){const e=[];for(let t=this._first;t!==d.Undefined;t=t.next)e.push(t.element);return e}}const ce=new ae,$t=ce.event;function xt(){const i=t=>{const n=document.body,o=window.getComputedStyle(n),a=n.classList.contains("vscode-light")||n.classList.contains("vscode-high-contrast-light"),s=n.style;s.setProperty("--font-family",o.getPropertyValue("--vscode-font-family").trim()),s.setProperty("--font-size",o.getPropertyValue("--vscode-font-size").trim()),s.setProperty("--font-weight",o.getPropertyValue("--vscode-font-weight").trim()),s.setProperty("--editor-font-family",o.getPropertyValue("--vscode-editor-font-family").trim()),s.setProperty("--editor-font-size",o.getPropertyValue("--vscode-editor-font-size").trim()),s.setProperty("--editor-font-weight",o.getPropertyValue("--vscode-editor-font-weight").trim());const l=o.getPropertyValue("--vscode-editor-background").trim();let r=l;s.setProperty("--color-background",r),s.setProperty("--color-background--lighten-05",m(r,5)),s.setProperty("--color-background--darken-05",g(r,5)),s.setProperty("--color-background--lighten-075",m(r,7.5)),s.setProperty("--color-background--darken-075",g(r,7.5)),s.setProperty("--color-background--lighten-10",m(r,10)),s.setProperty("--color-background--darken-10",g(r,10)),s.setProperty("--color-background--lighten-15",m(r,15)),s.setProperty("--color-background--darken-15",g(r,15)),s.setProperty("--color-background--lighten-30",m(r,30)),s.setProperty("--color-background--darken-30",g(r,30)),s.setProperty("--color-background--lighten-50",m(r,50)),s.setProperty("--color-background--darken-50",g(r,50)),r=o.getPropertyValue("--vscode-button-background").trim(),s.setProperty("--color-button-background",r),s.setProperty("--color-button-background--darken-30",g(r,30)),s.setProperty("--color-highlight",r),s.setProperty("--color-highlight--75",b(r,75)),s.setProperty("--color-highlight--50",b(r,50)),s.setProperty("--color-highlight--25",b(r,25)),r=o.getPropertyValue("--vscode-button-secondaryBackground").trim(),s.setProperty("--color-button-secondary-background",r),s.setProperty("--color-button-secondary-background--darken-30",g(r,30)),r=o.getPropertyValue("--vscode-button-foreground").trim(),s.setProperty("--color-button-foreground",r);let c=o.getPropertyValue("--vscode-editor-foreground").trim();c||(c=o.getPropertyValue("--vscode-foreground").trim()),s.setProperty("--color-foreground",c),s.setProperty("--color-foreground--85",b(c,85)),s.setProperty("--color-foreground--75",b(c,75)),s.setProperty("--color-foreground--65",b(c,65)),s.setProperty("--color-foreground--50",b(c,50)),r=o.getPropertyValue("--vscode-focusBorder").trim(),s.setProperty("--color-focus-border",r),r=o.getPropertyValue("--vscode-textLink-foreground").trim(),s.setProperty("--color-link-foreground",r),s.setProperty("--color-link-foreground--darken-20",g(r,20)),s.setProperty("--color-link-foreground--lighten-20",m(r,20)),r=o.getPropertyValue("--vscode-sideBar-background").trim(),s.setProperty("--color-view-background",r||l),r=o.getPropertyValue("--vscode-sideBar-foreground").trim(),s.setProperty("--color-view-foreground",r||c),s.setProperty("--color-view-header-foreground",o.getPropertyValue("--vscode-sideBarSectionHeader-foreground").trim()||r||c),r=o.getPropertyValue("--vscode-editorHoverWidget-background").trim(),s.setProperty("--color-hover-background",r),r=o.getPropertyValue("--vscode-editorHoverWidget-border").trim(),s.setProperty("--color-hover-border",r),r=o.getPropertyValue("--vscode-editorHoverWidget-foreground").trim(),s.setProperty("--color-hover-foreground",r),r=o.getPropertyValue("--vscode-editorHoverWidget-statusBarBackground").trim(),s.setProperty("--color-hover-statusBarBackground",r),s.setProperty("--graph-theme-opacity-factor",a?"0.5":"1"),s.setProperty("--color-graph-actionbar-background",a?g(l,5):m(l,5)),s.setProperty("--color-graph-actionbar-selectedBackground",a?g(l,10):m(l,10)),s.setProperty("--color-graph-background",a?g(l,5):m(l,5)),s.setProperty("--color-graph-background2",a?g(l,10):m(l,10)),r=o.getPropertyValue("--vscode-list-focusOutline").trim(),s.setProperty("--color-graph-contrast-border-color",r),r=o.getPropertyValue("--vscode-list-activeSelectionBackground").trim(),s.setProperty("--color-graph-selected-row",r),r=o.getPropertyValue("--vscode-list-hoverBackground").trim(),s.setProperty("--color-graph-hover-row",r),r=o.getPropertyValue("--vscode-list-activeSelectionForeground").trim(),s.setProperty("--color-graph-text-selected-row",r),s.setProperty("--color-graph-text-dimmed-selected",b(r,50)),s.setProperty("--color-graph-text-dimmed",b(c,20)),r=o.getPropertyValue("--vscode-list-hoverForeground").trim(),s.setProperty("--color-graph-text-hovered",r),s.setProperty("--color-graph-text-selected",c),s.setProperty("--color-graph-text-normal",b(c,85)),s.setProperty("--color-graph-text-secondary",b(c,65)),s.setProperty("--color-graph-text-disabled",b(c,50)),r=o.getPropertyValue("--vscode-inputValidation-infoBackground").trim(),s.setProperty("--color-alert-infoHoverBackground",a?g(r,5):m(r,5)),s.setProperty("--color-alert-infoBackground",r),r=o.getPropertyValue("--vscode-inputValidation-warningBackground").trim(),s.setProperty("--color-alert-warningHoverBackground",a?g(r,5):m(r,5)),s.setProperty("--color-alert-warningBackground",r),r=o.getPropertyValue("--vscode-inputValidation-errorBackground").trim(),s.setProperty("--color-alert-errorHoverBackground",a?g(r,5):m(r,5)),s.setProperty("--color-alert-errorBackground",r),r=a?g(l,5):m(l,5),s.setProperty("--color-alert-neutralHoverBackground",a?g(r,5):m(r,5)),s.setProperty("--color-alert-neutralBackground",r),s.setProperty("--color-alert-infoBorder","var(--vscode-inputValidation-infoBorder)"),s.setProperty("--color-alert-warningBorder","var(--vscode-inputValidation-warningBorder)"),s.setProperty("--color-alert-errorBorder","var(--vscode-inputValidation-errorBorder)"),s.setProperty("--color-alert-neutralBorder","var(--vscode-input-foreground)"),s.setProperty("--color-alert-foreground","var(--vscode-input-foreground)"),t!=null&&ce.fire()};i();const e=new MutationObserver(i);return e.observe(document.body,{attributeFilter:["class"]}),e}const Ct=2**30;let A=0;function ue(){return A===Ct?A=1:A++,`webview:${A}`}class It{constructor(e){this.appName=e,this.state=window.bootstrap,window.bootstrap=void 0,this.log(`${this.appName}()`),this._api=acquireVsCodeApi(),this.onThemeUpdated!=null&&$t(this.onThemeUpdated,this),xt(),requestAnimationFrame(()=>{this.log(`${this.appName}.initializing`);try{this.onInitialize?.(),this.bind(),this.onMessageReceived!=null&&window.addEventListener("message",this.onMessageReceived.bind(this)),this.sendCommand(_e,void 0),this.onInitialized?.()}finally{document.body.classList.contains("preload")&&setTimeout(()=>{document.body.classList.remove("preload")},500)}})}bind(){this.bindDisposables?.forEach(t=>t.dispose()),this.bindDisposables=this.onBind?.(),this.bindDisposables==null&&(this.bindDisposables=[]);const e=ht(t=>{this.sendCommand(Se,t)},150);this.bindDisposables.push(p.on(document,"focusin",t=>{const n=t.composedPath().some(o=>o.tagName==="INPUT");(this._focused!==!0||this._inputFocused!==n)&&(this._focused=!0,this._inputFocused=n,e({focused:!0,inputFocused:n}))}),p.on(document,"focusout",()=>{(this._focused!==!1||this._inputFocused!==!1)&&(this._focused=!1,this._inputFocused=!1,e({focused:!1,inputFocused:!1}))}))}log(e,...t){}getState(){return this._api.getState()}sendCommand(e,t){const n=ue();this.log(`${this.appName}.sendCommand(${n}): name=${e.method}`),this.postMessage({id:n,method:e.method,params:t})}async sendCommandWithCompletion(e,t,n){const o=ue();this.log(`${this.appName}.sendCommandWithCompletion(${o}): name=${e.method}`);const a=new Promise((s,l)=>{let r;const c=[p.on(window,"message",u=>{N(n,u.data,h=>{u.data.completionId===o&&(c.forEach(y=>y.dispose()),queueMicrotask(()=>s(h)))})}),{dispose:function(){r!=null&&(clearTimeout(r),r=void 0)}}];r=setTimeout(()=>{r=void 0,c.forEach(u=>u.dispose()),l(new Error(`Timed out waiting for completion of ${n.method}`))},6e4)});return this.postMessage({id:o,method:e.method,params:t,completionId:o}),a}setState(e){this.state=e,e!=null&&this._api.setState(e)}postMessage(e){this._api.postMessage(e)}}const de=new Date().getTimezoneOffset()/60*100,fe=new Date(`Wed Jul 25 2018 19:18:00 GMT${de>=0?"-":"+"}${String(Math.abs(de)).padStart(4,"0")}`);class Vt extends It{constructor(e){super(e),this._changes=Object.create(null),this._updating=!1}onInitialized(){this.updateState()}onBind(){const e=super.onBind?.()??[];return e.push(p.on("input[type=checkbox][data-setting]","change",(t,n)=>this.onInputChecked(n)),p.on("input[type=text][data-setting], input[type=number][data-setting], input:not([type])[data-setting]","blur",(t,n)=>this.onInputBlurred(n)),p.on("input[type=text][data-setting], input[type=number][data-setting], input:not([type])[data-setting]","focus",(t,n)=>this.onInputFocused(n)),p.on("input[type=text][data-setting][data-setting-preview], input[type=number][data-setting][data-setting-preview]","input",(t,n)=>this.onInputChanged(n)),p.on("button[data-setting-clear]","click",(t,n)=>this.onButtonClicked(n)),p.on("select[data-setting]","change",(t,n)=>this.onInputSelected(n)),p.on(".token[data-token]","mousedown",(t,n)=>this.onTokenMouseDown(n,t))),e}onMessageReceived(e){const t=e.data;switch(this.log(`${this.appName}.onMessageReceived(${t.id}): name=${t.method}`),t.method){case J.method:{N(J,t,n=>{this.scrollToAnchor(n.anchor,n.scrollBehavior)});break}case G.method:N(G,t,n=>{this.state.config=n.config,this.state.customSettings=n.customSettings,this.updateState()});break;default:super.onMessageReceived?.(e)}}applyChanges(){this.sendCommand(we,{changes:{...this._changes},removes:Object.keys(this._changes).filter(e=>this._changes[e]===void 0),scope:this.getSettingsScope()}),this._changes=Object.create(null)}getSettingsScope(){return"user"}onInputBlurred(e){this.log(`${this.appName}.onInputBlurred: name=${e.name}, value=${e.value}`);const t=document.getElementById(`${e.name}.popup`);t?.classList.add("hidden");let n=e.value;if((n==null||n.length===0)&&(n=e.dataset.defaultValue,n===void 0&&(n=null)),e.dataset.settingType==="arrayObject"){const o=e.name.split("."),a=o[0],s=parseInt(o[1],10),l=o.slice(2);let r=this.getSettingValue(a);if(n==null&&(r===void 0||r?.length===0))r!==void 0&&(this._changes[a]=void 0);else{r=r??[];let c=r[s];(n!=null||n==null&&c!==void 0)&&(c===void 0&&(c=Object.create(null),r[s]=c),I(c,l.join("."),e.type==="number"&&n!=null?Number(n):n),this._changes[a]=r)}}else this._changes[e.name]=e.type==="number"&&n!=null?Number(n):n;this.applyChanges()}onButtonClicked(e){if(e.dataset.settingType==="arrayObject"){const t=e.name.split("."),n=t[0],o=this.getSettingValue(n);if(o===void 0)return;const a=parseInt(t[1],10);if(o[a]==null)return;o.splice(a,1),this._changes[n]=o.length?o:void 0,this.applyChanges()}}onInputChanged(e){if(!this._updating)for(const t of document.querySelectorAll(`span[data-setting-preview="${e.name}"]`))this.updatePreview(t,e.value)}onInputChecked(e){if(!this._updating){switch(this.log(`${this.appName}.onInputChecked: name=${e.name}, checked=${e.checked}, value=${e.value}`),e.dataset.settingType){case"object":{const t=e.name.split("."),n=t.splice(0,1)[0],o=this.getSettingValue(n)??Object.create(null);e.checked?I(o,t.join("."),W(e.value)):I(o,t.join("."),!1),this._changes[n]=o;break}case"array":{const t=this.getSettingValue(e.name)??[];if(Array.isArray(t)){if(e.checked)t.includes(e.value)||t.push(e.value);else{const n=t.indexOf(e.value);n!==-1&&t.splice(n,1)}this._changes[e.name]=t}break}case"arrayObject":{const t=e.name.split("."),n=t[0],o=parseInt(t[1],10),a=t.slice(2),s=this.getSettingValue(n)??[],l=s[o]??Object.create(null);s[o]===void 0&&(s[o]=l),e.checked?I(s[o],a.join("."),W(e.value)):I(s[o],a.join("."),!1),this._changes[n]=s;break}case"custom":{this._changes[e.name]=e.checked;break}default:{e.checked?this._changes[e.name]=W(e.value):this._changes[e.name]=e.dataset.valueOff==null?!1:e.dataset.valueOff;break}}this.setAdditionalSettings(e.checked?e.dataset.addSettingsOn:e.dataset.addSettingsOff),this.applyChanges()}}onInputFocused(e){this.log(`${this.appName}.onInputFocused: name=${e.name}, value=${e.value}`);const t=document.getElementById(`${e.name}.popup`);if(t!=null){if(t.childElementCount===0){const n=document.querySelector("#token-popup")?.content.cloneNode(!0);n!=null&&t.appendChild(n)}t.classList.remove("hidden")}}onInputSelected(e){if(this._updating)return;const t=e.options[e.selectedIndex].value;this.log(`${this.appName}.onInputSelected: name=${e.name}, value=${t}`),this._changes[e.name]=pe(t),this.applyChanges()}onTokenMouseDown(e,t){if(this._updating)return;this.log(`${this.appName}.onTokenClicked: id=${e.id}`);const n=e.closest(".setting");if(n==null)return;const o=n.querySelector("input[type=text], input:not([type])");if(o==null)return;const a=`\${${e.dataset.token}}`;let s=o.selectionStart;s!=null?(o.value=`${o.value.substring(0,s)}${a}${o.value.substr(o.selectionEnd??s)}`,s+=a.length):s=o.value.length,o.focus(),o.setSelectionRange(s,s),s===o.value.length&&(o.scrollLeft=o.scrollWidth),setTimeout(()=>this.onInputChanged(o),0),setTimeout(()=>o.focus(),250),t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault()}scrollToAnchor(e,t,n){const o=document.getElementById(e);o!=null&&this.scrollTo(o,t,n)}scrollTo(e,t,n){const o=e.getBoundingClientRect().top-document.body.getBoundingClientRect().top-(n??0);window.scrollTo({top:o,behavior:t??"smooth"});const a=()=>{this._scrollTimer!=null&&clearTimeout(this._scrollTimer),this._scrollTimer=setTimeout(()=>{window.removeEventListener("scroll",a);const s=e.getBoundingClientRect().top-document.body.getBoundingClientRect().top-(n??0);o!==s&&this.scrollTo(e,t,n)},50)};window.addEventListener("scroll",a,!1)}evaluateStateExpression(e,t){let n=!1;for(const o of e.trim().split("&")){const[a,s,l]=Ot(o);switch(s){case"=":{let r=t[a];r===void 0&&(r=this.getSettingValue(a)??!1),n=l!==void 0?l===String(r):Boolean(r);break}case"!":{let r=t[a];r===void 0&&(r=this.getSettingValue(a)??!1),n=l!==void 0?l!==String(r):!r;break}case"+":{if(l!==void 0){const r=this.getSettingValue(a);n=r!==void 0?r.includes(l.toString()):!1}break}}if(!n)break}return n}getCustomSettingValue(e){return this.state.customSettings?.[e]}getSettingValue(e){const t=this.getCustomSettingValue(e);return t??Bt(this.state.config,e)}updateState(){this.beforeUpdateState?.(),this._updating=!0,xe(this.state.config.defaultDateLocale);try{for(const t of document.querySelectorAll("input[type=checkbox][data-setting]"))if(t.dataset.settingType==="custom")t.checked=this.getCustomSettingValue(t.name)??!1;else if(t.dataset.settingType==="array")t.checked=(this.getSettingValue(t.name)??[]).includes(t.value);else if(t.dataset.valueOff!=null){const n=this.getSettingValue(t.name);t.checked=t.dataset.valueOff!==n}else t.checked=this.getSettingValue(t.name)??!1;for(const t of document.querySelectorAll("input[type=text][data-setting], input[type=number][data-setting], input:not([type])[data-setting]"))t.value=this.getSettingValue(t.name)??"";for(const t of document.querySelectorAll("select[data-setting]")){const n=this.getSettingValue(t.name),o=t.querySelector(`option[value='${n}']`);o!=null&&(o.selected=!0)}for(const t of document.querySelectorAll("span[data-setting-preview]"))this.updatePreview(t)}finally{this._updating=!1}const e=ge(this.state.config);if(this.state.customSettings!=null)for(const[t,n]of Object.entries(this.state.customSettings))e[t]=n;this.setVisibility(e),this.setEnablement(e)}setAdditionalSettings(e){if(!e)return;const t=jt(e);for(const[n,o]of t)this._changes[n]=o}setEnablement(e){for(const t of document.querySelectorAll("[data-enablement]")){const n=!this.evaluateStateExpression(t.dataset.enablement,e);if(n?t.setAttribute("disabled",""):t.removeAttribute("disabled"),t.matches("input,select"))t.disabled=n;else{const o=t.querySelector("input,select");if(o==null)continue;o.disabled=n}}}setVisibility(e){for(const t of document.querySelectorAll("[data-visibility]"))t.classList.toggle("hidden",!this.evaluateStateExpression(t.dataset.visibility,e))}updatePreview(e,t){const n=e.dataset.settingPreviewType;switch(n){case"date":{if(t===void 0&&(t=this.getSettingValue(e.dataset.settingPreview)),!t&&(t=e.dataset.settingPreviewDefault,t==null)){const o=e.dataset.settingPreviewDefaultLookup;o!=null&&(t=this.getSettingValue(o))}e.innerText=t==null?"":K(fe,t,void 0,!1);break}case"date-locale":{t===void 0&&(t=this.getSettingValue(e.dataset.settingPreview)),t||(t=void 0);const o=this.getSettingValue(e.dataset.settingPreviewDefault)??"MMMM Do, YYYY h:mma";try{e.innerText=K(fe,o,t,!1)}catch(a){e.innerText=a.message}break}case"commit":case"commit-uncommitted":{if(t===void 0&&(t=this.getSettingValue(e.dataset.settingPreview)),!t&&(t=e.dataset.settingPreviewDefault,t==null)){const o=e.dataset.settingPreviewDefaultLookup;o!=null&&(t=this.getSettingValue(o))}if(t==null){e.innerText="";return}this.sendCommandWithCompletion(Pe,{key:e.dataset.settingPreview,type:n,format:t},Te).then(o=>{e.innerText=o.preview??""});break}default:break}}}function pe(i){return i==="true"?!0:i==="false"?!1:i==="null"?null:i}function Bt(i,e){return e.split(".").reduce((t={},n)=>t?.[n],i)}function I(i,e,t){const n=e.split("."),o=n.length,a=o-1;let s=-1,l=i;for(;l!=null&&++s<o;){const r=n[s];let c=t;if(s!==a){const u=l[r];c=typeof u=="object"?u:{}}l[r]=c,l=l[r]}return i}function jt(i){return i.trim().split(",").map(t=>{const[n,o]=t.split("=");return[n,pe(o)]})}function Ot(i){const[e,t,n]=i.trim().split(/([=+!])/);return[e.trim(),t!==void 0?t.trim():"=",n!==void 0?n.trim():n]}function ge(i,e){const t={};for(const n in i){const o=i[n];Array.isArray(o)||(typeof o=="object"?Object.assign(t,ge(o,e===void 0?n:`${e}.${n}`)):t[e===void 0?n:`${e}.${n}`]=o)}return t}function W(i){switch(i){case"on":return!0;case"null":return null;case"undefined":return;default:return i}}const he=83;class Et extends Vt{constructor(){super("SettingsApp"),this._scopes=null,this._activeSection="general",this._sections=new Map}onInitialize(){const e=document.getElementById("scopes");if(e!=null&&this.state.scopes.length>1){for(const[o,a]of this.state.scopes){const s=document.createElement("option");s.value=o,s.innerHTML=a,this.state.scope===o&&(s.selected=!0),e.appendChild(s)}e.parentElement.parentElement.classList.remove("hidden"),this._scopes=e}let t=he;const n=document.querySelector(".hero__area--sticky");n!=null&&(t=n.clientHeight),this._observer=new IntersectionObserver(this.onObserver.bind(this),{rootMargin:`-${t}px 0px 0px 0px`});for(const o of document.querySelectorAll("section[id]>.section__header"))this._sections.set(o.parentElement.id,!1),this._observer.observe(o);for(const o of document.querySelectorAll("[data-setting]")){!o.title&&o.type==="checkbox"&&(o.title=`Setting name: "gitlens.${o.name}"`);for(const a of document.querySelectorAll(`label[for="${o.id}"]`))a.title||(a.title=`Setting name: "gitlens.${o.name}"`)}}beforeUpdateState(){const e=document.activeElement?.id;this.renderAutolinks(),e?.startsWith("autolinks.")&&queueMicrotask(()=>{document.getElementById(e)?.focus()})}onBind(){const e=super.onBind?.()??[];return e.push(p.on(".section--collapsible>.section__header","click",(t,n)=>this.onSectionHeaderClicked(n,t)),p.on(".setting--expandable .setting__expander","click",(t,n)=>this.onSettingExpanderCicked(n,t)),p.on('a[data-action="jump"]',"mousedown",t=>{t.stopPropagation(),t.preventDefault()}),p.on('a[data-action="jump"]',"click",(t,n)=>this.onJumpToLinkClicked(n,t)),p.on("[data-action]","mousedown",t=>{t.stopPropagation(),t.preventDefault()}),p.on("[data-action]","click",(t,n)=>this.onActionLinkClicked(n,t))),e}scrollToAnchor(e,t){let n=he;const o=document.querySelector(".hero__area--sticky");o!=null&&(n=o.clientHeight),super.scrollToAnchor(e,t,n)}onObserver(e,t){for(const o of e)this._sections.set(o.target.parentElement.id,o.isIntersecting);let n;for(const[o,a]of this._sections.entries())if(a){n=o;break}if(n===void 0){if(e.length!==1)return;const o=e[0];if(o.boundingClientRect==null||o.rootBounds==null)return;if(n=o.target.parentElement.id,o.boundingClientRect.top>=o.rootBounds.bottom){const a=[...this._sections.keys()],s=a.indexOf(n);if(s<=0)return;n=a[s-1]}}this._activeSection!==n&&(this._activeSection!==void 0&&this.toggleJumpLink(this._activeSection,!1),this._activeSection=n,this.toggleJumpLink(this._activeSection,!0))}getSettingsScope(){return this._scopes!=null?this._scopes.options[this._scopes.selectedIndex].value:"user"}onActionLinkClicked(e,t){switch(e.dataset.action){case"collapse":for(const n of document.querySelectorAll(".section--collapsible"))n.classList.add("collapsed");document.querySelector('[data-action="collapse"]').classList.add("hidden"),document.querySelector('[data-action="expand"]').classList.remove("hidden");break;case"expand":for(const n of document.querySelectorAll(".section--collapsible"))n.classList.remove("collapsed");document.querySelector('[data-action="collapse"]').classList.remove("hidden"),document.querySelector('[data-action="expand"]').classList.add("hidden");break;case"show":if(e.dataset.actionTarget)for(const n of document.querySelectorAll(`[data-region="${e.dataset.actionTarget}"]`))n.classList.remove("hidden"),n.querySelector("input,select,textarea,button")?.focus();break;case"hide":if(e.dataset.actionTarget)for(const n of document.querySelectorAll(`[data-region="${e.dataset.actionTarget}"]`))n.classList.add("hidden");break}t.preventDefault(),t.stopPropagation()}onInputSelected(e){e!==this._scopes&&super.onInputSelected(e)}onJumpToLinkClicked(e,t){const n=e.getAttribute("href");if(n==null)return;const o=n.substr(1);this.scrollToAnchor(o,"smooth"),t.stopPropagation(),t.preventDefault()}onSectionHeaderClicked(e,t){t.target.matches("a, input, label, i.icon__info")||e.parentElement.classList.toggle("collapsed")}onSettingExpanderCicked(e,t){e.parentElement.parentElement.classList.toggle("expanded")}toggleJumpLink(e,t){const n=document.querySelector(`a.sidebar__jump-link[href="#${e}"]`);n?.classList.toggle("active",t)}renderAutolinks(){const e=document.querySelector('[data-component="autolinks"]');if(e==null)return;const t=()=>`
			<div class="setting__hint">
				<span style="line-height: 2rem">
					<i class="icon icon--sm icon__info"></i> Matches prefixes that are followed by a reference value within commit messages.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The URL must contain a <code>&lt;num&gt;</code> for the reference value to be included in the link.
				</span>
			</div>
		`,n=(s,l,r=!1,c=!0)=>`
			<div class="setting${r?' hidden" data-region="autolink':""}">
				<div class="setting__group">
					<div class="setting__input setting__input--short setting__input--with-actions">
						<label for="autolinks.${s}.prefix">Prefix</label>
						<input
							id="autolinks.${s}.prefix"
							name="autolinks.${s}.prefix"
							placeholder="TICKET-"
							data-setting
							data-setting-type="arrayObject"
							${l?.prefix?`value="${encodeURIComponent(l.prefix)}"`:""}
						>
						<div class="setting__input-actions">
							<div class="toggle-button">
								<input
									id="autolinks.${s}.ignoreCase"
									name="autolinks.${s}.ignoreCase"
									type="checkbox"
									class="toggle-button__control"
									data-setting
									data-setting-type="arrayObject"
									${l?.ignoreCase?"checked":""}
								>
								<label class="toggle-button__label" for="autolinks.${s}.ignoreCase" title="Case-sensitive" aria-label="Case-sensitive">Aa</label>
							</div>
							<div class="toggle-button">
								<input
									id="autolinks.${s}.alphanumeric"
									name="autolinks.${s}.alphanumeric"
									type="checkbox"
									class="toggle-button__control"
									data-setting
									data-setting-type="arrayObject"
									${l?.alphanumeric?"checked":""}
								>
								<label class="toggle-button__label" for="autolinks.${s}.alphanumeric" title="Alphanumeric" aria-label="Alphanumeric">a1</label>
							</div>
						</div>
					</div>
					<div class="setting__input setting__input--long setting__input--centered">
						<label for="autolinks.${s}.url">URL</label>
						<input
							id="autolinks.${s}.url"
							name="autolinks.${s}.url"
							type="text"
							placeholder="https://example.com/TICKET?q=&lt;num&gt;"
							data-setting
							data-setting-type="arrayObject"
							${l?.url?`value="${encodeURIComponent(l.url)}"`:""}
						>
						${r?`
							<button
								class="button button--compact button--flat-subtle"
								type="button"
								data-action="hide"
								data-action-target="autolink"
								title="Delete"
								aria-label="Delete"
							><i class="codicon codicon-close"></i></button>
						`:`
							<button
								id="autolinks.${s}.delete"
								name="autolinks.${s}.delete"
								class="button button--compact button--flat-subtle"
								type="button"
								data-setting-type="arrayObject"
								data-setting-clear
								title="Delete"
								aria-label="Delete"
							><i class="codicon codicon-close"></i></button>
						`}
					</div>
				</div>
				${c&&r?t():""}
			</div>
		`,o=[],a=(this.state.config.autolinks?.length||0)>0;a&&this.state.config.autolinks?.forEach((s,l)=>o.push(n(l,s))),o.push(n(this.state.config.autolinks?.length??0,void 0,!0,!a)),a&&o.push(t()),e.innerHTML=o.join("")}}new Et})();
