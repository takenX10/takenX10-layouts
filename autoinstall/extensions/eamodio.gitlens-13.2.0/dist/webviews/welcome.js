(()=>{"use strict";var Dt={};class Y{constructor(e,t=!1){this.method=e,this.overwriteable=t}}class x extends Y{}class F extends Y{}function A(o,e,t){o.method===e.method&&t(e.params,o)}const ke=new x("webview/ready"),Pe=new x("webview/focus"),Mt=new x("command/execute"),_e=new x("configuration/preview"),we=new x("configuration/update"),G=new F("configuration/didChange"),Se=new F("configuration/didPreview"),Q=new F("webview/didOpenAnchor"),Z=/(?<literal>\[.*?\])|(?<year>YYYY|YY)|(?<month>M{1,4})|(?<day>Do|DD?)|(?<weekday>d{2,4})|(?<hour>HH?|hh?)|(?<minute>mm?)|(?<second>ss?)|(?<fractionalSecond>SSS)|(?<dayPeriod>A|a)|(?<timeZoneName>ZZ?)/g,J=/(?<dateStyle>full|long|medium|short)(?:\+(?<timeStyle>full|long|medium|short))?/,Te=null;let S;const $=new Map;let P,T,_;function xe(o){typeof o=="string"?o==="system"?P=void 0:P=[o]:P=o??void 0,T=void 0,_=void 0,$.clear(),S=void 0}function Et(o,e){const t=new Date(o.getTime());for(const[n,r]of Object.entries(e))if(r)switch(n){case"years":t.setFullYear(t.getFullYear()+r);break;case"months":t.setMonth(t.getMonth()+r);break;case"days":t.setDate(t.getDate()+r);break;case"hours":t.setHours(t.getHours()+r);break;case"minutes":t.setMinutes(t.getMinutes()+r);break;case"seconds":t.setSeconds(t.getSeconds()+r);break}return t}function Ft(o,e){const t=(typeof o=="number"?o:o.getTime())-new Date().getTime();for(const[n,r,a,i]of Te){const c=Math.abs(t);if(c>=r||r===1e3)return e?(S==null&&(_!=null?S=_.resolvedOptions().locale:T!=null?S=T.resolvedOptions().locale:(_=new Intl.RelativeTimeFormat(P,{localeMatcher:"best fit",numeric:"always",style:"narrow"}),S=_.resolvedOptions().locale)),S==="en"||S?.startsWith("en-")?`${Math.round(c/a)}${i}`:(_==null&&(_=new Intl.RelativeTimeFormat(P,{localeMatcher:"best fit",numeric:"always",style:"narrow"})),_.format(Math.round(t/a),n))):(T==null&&(T=new Intl.RelativeTimeFormat(P,{localeMatcher:"best fit",numeric:"auto",style:"long"})),T.format(Math.round(t/a),n))}return""}function X(o,e,t,n=!0){e=e??void 0;const r=`${t??""}:${e}`;let a=$.get(r);if(a==null){const s=$e(e);let l;t==null?l=P:t==="system"?l=void 0:l=[t],a=new Intl.DateTimeFormat(l,s),n&&$.set(r,a)}if(e==null||J.test(e))return a.format(o);function i(s){const l=`${t??""}:time:${s}`;let u=$.get(l);if(u==null){const p={localeMatcher:"best fit",timeStyle:s};let m;t==null?m=P:t==="system"?m=void 0:m=[t],u=new Intl.DateTimeFormat(m,p),n&&$.set(l,u)}return u}const c=a.formatToParts(o);return e.replace(Z,(s,l,u,p,m,M,he,me,q,V,H,ye,ve,E,f)=>{if(l!=null)return l.substring(1,l.length-1);for(const b in f){const k=f[b];if(k==null)continue;const w=c.find(be=>be.type===b);return k==="Do"&&w?.type==="day"?Ie(Number(w.value)):k==="a"&&w?.type==="dayPeriod"?` ${(i("short").formatToParts(o).find(Nt=>Nt.type==="dayPeriod")??w)?.value??""}`:w?.value??""}return""})}function At(o,e,t){const n=(typeof e=="number"?e:e.getTime())-(typeof o=="number"?o:o.getTime());switch(t){case"days":return Math.floor(n/(1e3*60*60*24));case"hours":return Math.floor(n/(1e3*60*60));case"minutes":return Math.floor(n/(1e3*60));case"seconds":return Math.floor(n/1e3);default:return n}}function $e(o){if(o==null)return{localeMatcher:"best fit",dateStyle:"full",timeStyle:"short"};const e=J.exec(o);if(e?.groups!=null){const{dateStyle:n,timeStyle:r}=e.groups;return{localeMatcher:"best fit",dateStyle:n||"full",timeStyle:r||void 0}}const t={localeMatcher:"best fit"};for(const{groups:n}of o.matchAll(Z))if(n!=null)for(const r in n){const a=n[r];if(a!=null)switch(r){case"year":t.year=a.length===4?"numeric":"2-digit";break;case"month":switch(a.length){case 4:t.month="long";break;case 3:t.month="short";break;case 2:t.month="2-digit";break;case 1:t.month="numeric";break}break;case"day":a==="DD"?t.day="2-digit":t.day="numeric";break;case"weekday":switch(a.length){case 4:t.weekday="long";break;case 3:t.weekday="short";break;case 2:t.weekday="narrow";break}break;case"hour":t.hour=a.length===2?"2-digit":"numeric",t.hour12=a==="hh"||a==="h";break;case"minute":t.minute=a.length===2?"2-digit":"numeric";break;case"second":t.second=a.length===2?"2-digit":"numeric";break;case"fractionalSecond":t.fractionalSecondDigits=3;break;case"dayPeriod":t.dayPeriod="narrow",t.hour12=!0,t.hourCycle="h12";break;case"timeZoneName":t.timeZoneName=a.length===2?"long":"short";break}}return t}const L=["th","st","nd","rd"];function Ie(o){const e=o%100;return`${o}${L[(e-20)%10]??L[e]??L[0]}`}function Ce(o){var e=typeof o;return o!=null&&(e=="object"||e=="function")}const U=Ce;var Ve=typeof global=="object"&&global&&global.Object===Object&&global;const Be=Ve;var je=typeof self=="object"&&self&&self.Object===Object&&self,Oe=Be||je||Function("return this")();const K=Oe;var Ne=function(){return K.Date.now()};const R=Ne;var De=/\s/;function Me(o){for(var e=o.length;e--&&De.test(o.charAt(e)););return e}const Ee=Me;var Fe=/^\s+/;function Ae(o){return o&&o.slice(0,Ee(o)+1).replace(Fe,"")}const Le=Ae;var Ue=K.Symbol;const B=Ue;var ee=Object.prototype,Re=ee.hasOwnProperty,We=ee.toString,I=B?B.toStringTag:void 0;function ze(o){var e=Re.call(o,I),t=o[I];try{o[I]=void 0;var n=!0}catch{}var r=We.call(o);return n&&(e?o[I]=t:delete o[I]),r}const qe=ze;var He=Object.prototype,Ye=He.toString;function Ge(o){return Ye.call(o)}const Qe=Ge;var Ze="[object Null]",Je="[object Undefined]",te=B?B.toStringTag:void 0;function Xe(o){return o==null?o===void 0?Je:Ze:te&&te in Object(o)?qe(o):Qe(o)}const Ke=Xe;function et(o){return o!=null&&typeof o=="object"}const tt=et;var nt="[object Symbol]";function ot(o){return typeof o=="symbol"||tt(o)&&Ke(o)==nt}const rt=ot;var ne=0/0,it=/^[-+]0x[0-9a-f]+$/i,st=/^0b[01]+$/i,at=/^0o[0-7]+$/i,ct=parseInt;function lt(o){if(typeof o=="number")return o;if(rt(o))return ne;if(U(o)){var e=typeof o.valueOf=="function"?o.valueOf():o;o=U(e)?e+"":e}if(typeof o!="string")return o===0?o:+o;o=Le(o);var t=st.test(o);return t||at.test(o)?ct(o.slice(2),t?2:8):it.test(o)?ne:+o}const oe=lt;var ut="Expected a function",dt=Math.max,ft=Math.min;function gt(o,e,t){var n,r,a,i,c,s,l=0,u=!1,p=!1,m=!0;if(typeof o!="function")throw new TypeError(ut);e=oe(e)||0,U(t)&&(u=!!t.leading,p="maxWait"in t,a=p?dt(oe(t.maxWait)||0,e):a,m="trailing"in t?!!t.trailing:m);function M(f){var b=n,k=r;return n=r=void 0,l=f,i=o.apply(k,b),i}function he(f){return l=f,c=setTimeout(V,e),u?M(f):i}function me(f){var b=f-s,k=f-l,w=e-b;return p?ft(w,a-k):w}function q(f){var b=f-s,k=f-l;return s===void 0||b>=e||b<0||p&&k>=a}function V(){var f=R();if(q(f))return H(f);c=setTimeout(V,me(f))}function H(f){return c=void 0,m&&n?M(f):(n=r=void 0,i)}function ye(){c!==void 0&&clearTimeout(c),l=0,n=s=r=c=void 0}function ve(){return c===void 0?i:H(R())}function E(){var f=R(),b=q(f);if(n=arguments,r=this,s=f,b){if(c===void 0)return he(s);if(p)return clearTimeout(c),c=setTimeout(V,e),M(s)}return c===void 0&&(c=setTimeout(V,e)),i}return E.cancel=ye,E.flush=ve,E}const re=gt;function pt(o,e,t){const{track:n,...r}={track:!1,...t??{}};if(n!==!0)return re(o,e,r);let a=!1;const i=re(function(...s){return a=!1,o.apply(this,s)},e,t),c=function(...s){return a=!0,i.apply(this,s)};return c.pending=function(){return a},c.cancel=function(){return i.cancel.apply(i)},c.flush=function(){return i.flush.apply(i)},c}const ht=",",ie="",mt="=",yt="{",vt="(",bt=")",kt=/\(([\s\S]*)\)/,Pt=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,_t=/\s?=.*$/;function Lt(o){if(typeof o!="function")throw new Error("Not supported");if(o.length===0)return[];let e=Function.prototype.toString.call(o);e=e.replace(Pt,ie)||e,e=e.slice(0,e.indexOf(yt));let t=e.indexOf(vt),n=e.indexOf(bt);t=t>=0?t+1:0,n=n>0?n:e.indexOf(mt),e=e.slice(t,n),e=`(${e})`;const r=kt.exec(e);return r!=null?r[1].split(ht).map(a=>a.trim().replace(_t,ie)):[]}function Ut(o,e,t){return e==null?o!=null:typeof e=="function"?e(o):t===void 0?o[e]!==void 0:o[e]===t}function Rt(o){return _once(o)}function Wt(o,e){const t=(n,r)=>{const a=t.value===void 0?r:`${t.value}.${r}`;return t.value=a,Object.assign(c=>t(n[r],c),{value:a})};return t(o,e)}function zt(o,e){let t;const n={dispose:()=>{t!=null&&(clearInterval(t),t=void 0)}};return t=setInterval(o,e),n}async function qt(o,e,t){for(const n of e)try{await o.apply(t,n)}catch{}}function Ht(o,e){return o>=e?o*o+o+e:o+e*e}async function Yt(o){await new Promise(e=>setTimeout(e,o))}var y;(o=>{function e(r,a,i,c){let s=!1;if(typeof r=="string"){const u=function(p){const m=p?.target?.closest(r);m!=null&&i(p,m)};return document.addEventListener(a,u,c??!0),{dispose:()=>{s||(s=!0,document.removeEventListener(a,u,c??!0))}}}const l=function(u){i(u,this)};return r.addEventListener(a,l,c??!1),{dispose:()=>{s||(s=!0,r.removeEventListener(a,l,c??!1))}}}o.on=e;function t(r,a,i){const c=document.getElementById(r);if(a.replaceChildren(c?.content.cloneNode(!0)),a.className=c.className,i?.visible!=null){const s=a.querySelectorAll("[data-visible]");for(const l of s){const u=l.dataset.visible;u&&(i.visible[u]?l.style.display="initial":l.style.display="none")}}if(i?.bindings!=null){const s=a.querySelectorAll("[data-bind]");for(const l of s){const u=l.dataset.bind;if(!u)continue;const p=i.bindings[u];p!=null&&(l.textContent=String(p))}}}o.insertTemplate=t;function n(r){r.replaceChildren(),r.className=""}o.resetSlot=n})(y||(y={}));const wt=/^(?:(#?)([0-9a-f]{3}|[0-9a-f]{6})|((?:rgb|hsl)a?)\((-?\d+%?)[,\s]+(-?\d+%?)[,\s]+(-?\d+%?)[,\s]*(-?[\d.]+%?)?\))$/i;function W(o,e){const t=o+e,n=e<0?t<0?0:t:t>255?255:t;return Math.round(n)}function g(o,e){return h(o,-e)}function h(o,e){const t=O(o);if(t==null)return o;const[n,r,a,i]=t,c=255*e/100;return`rgba(${W(n,c)}, ${W(r,c)}, ${W(a,c)}, ${i})`}function v(o,e){const t=O(o);if(t==null)return o;const[n,r,a,i]=t;return`rgba(${n}, ${r}, ${a}, ${i*(e/100)})`}function Gt(o,e,t){const n=O(o),r=O(e);if(n==null||r==null)return o;const[a,i,c,s]=n,[l,u,p,m]=r;return`rgba(${j(a,l,t)}, ${j(i,u,t)}, ${j(c,p,t)}, ${j(s,m,t)})`}const j=(o,e,t)=>o+(e-o)*t/100;function O(o){o=o.trim();const e=wt.exec(o);if(e==null)return null;if(e[1]==="#"){const t=e[2];switch(t.length){case 3:return[parseInt(t[0]+t[0],16),parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),1];case 6:return[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16),1]}return null}switch(e[3]){case"rgb":return[parseInt(e[4],10),parseInt(e[5],10),parseInt(e[6],10),1];case"rgba":return[parseInt(e[4],10),parseInt(e[5],10),parseInt(e[6],10),parseFloat(e[7])];default:return null}}const se=class{constructor(){this._disposed=!1}get event(){return this._event==null&&(this._event=(o,e,t)=>{this.listeners==null&&(this.listeners=new ce);const n=this.listeners.push(e==null?o:[o,e]),r={dispose:()=>{r.dispose=se._noop,this._disposed||n()}};return Array.isArray(t)&&t.push(r),r}),this._event}fire(o){if(this.listeners!=null){this._deliveryQueue==null&&(this._deliveryQueue=new ce);for(let e=this.listeners.iterator(),t=e.next();!t.done;t=e.next())this._deliveryQueue.push([t.value,o]);for(;this._deliveryQueue.size>0;){const[e,t]=this._deliveryQueue.shift();try{typeof e=="function"?e(t):e[0].call(e[1],t)}catch{}}}}dispose(){this.listeners?.clear(),this._deliveryQueue?.clear(),this._disposed=!0}};let ae=se;ae._noop=function(){};const St={done:!0,value:void 0},N=class{constructor(o){this.element=o,this.next=N.Undefined,this.prev=N.Undefined}};let d=N;d.Undefined=new N(void 0);class ce{constructor(){this._first=d.Undefined,this._last=d.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===d.Undefined}clear(){this._first=d.Undefined,this._last=d.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const n=new d(e);if(this._first===d.Undefined)this._first=n,this._last=n;else if(t){const a=this._last;this._last=n,n.prev=a,a.next=n}else{const a=this._first;this._first=n,n.next=a,a.prev=n}this._size+=1;let r=!1;return()=>{r||(r=!0,this._remove(n))}}shift(){if(this._first===d.Undefined)return;const e=this._first.element;return this._remove(this._first),e}pop(){if(this._last===d.Undefined)return;const e=this._last.element;return this._remove(this._last),e}_remove(e){if(e.prev!==d.Undefined&&e.next!==d.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===d.Undefined&&e.next===d.Undefined?(this._first=d.Undefined,this._last=d.Undefined):e.next===d.Undefined?(this._last=this._last.prev,this._last.next=d.Undefined):e.prev===d.Undefined&&(this._first=this._first.next,this._first.prev=d.Undefined);this._size-=1}iterator(){let e,t=this._first;return{next:function(){return t===d.Undefined?St:(e==null?e={done:!1,value:t.element}:e.value=t.element,t=t.next,e)}}}toArray(){const e=[];for(let t=this._first;t!==d.Undefined;t=t.next)e.push(t.element);return e}}const le=new ae,Tt=le.event;function xt(){const o=t=>{const n=document.body,r=window.getComputedStyle(n),a=n.classList.contains("vscode-light")||n.classList.contains("vscode-high-contrast-light"),i=n.style;i.setProperty("--font-family",r.getPropertyValue("--vscode-font-family").trim()),i.setProperty("--font-size",r.getPropertyValue("--vscode-font-size").trim()),i.setProperty("--font-weight",r.getPropertyValue("--vscode-font-weight").trim()),i.setProperty("--editor-font-family",r.getPropertyValue("--vscode-editor-font-family").trim()),i.setProperty("--editor-font-size",r.getPropertyValue("--vscode-editor-font-size").trim()),i.setProperty("--editor-font-weight",r.getPropertyValue("--vscode-editor-font-weight").trim());const c=r.getPropertyValue("--vscode-editor-background").trim();let s=c;i.setProperty("--color-background",s),i.setProperty("--color-background--lighten-05",h(s,5)),i.setProperty("--color-background--darken-05",g(s,5)),i.setProperty("--color-background--lighten-075",h(s,7.5)),i.setProperty("--color-background--darken-075",g(s,7.5)),i.setProperty("--color-background--lighten-10",h(s,10)),i.setProperty("--color-background--darken-10",g(s,10)),i.setProperty("--color-background--lighten-15",h(s,15)),i.setProperty("--color-background--darken-15",g(s,15)),i.setProperty("--color-background--lighten-30",h(s,30)),i.setProperty("--color-background--darken-30",g(s,30)),i.setProperty("--color-background--lighten-50",h(s,50)),i.setProperty("--color-background--darken-50",g(s,50)),s=r.getPropertyValue("--vscode-button-background").trim(),i.setProperty("--color-button-background",s),i.setProperty("--color-button-background--darken-30",g(s,30)),i.setProperty("--color-highlight",s),i.setProperty("--color-highlight--75",v(s,75)),i.setProperty("--color-highlight--50",v(s,50)),i.setProperty("--color-highlight--25",v(s,25)),s=r.getPropertyValue("--vscode-button-secondaryBackground").trim(),i.setProperty("--color-button-secondary-background",s),i.setProperty("--color-button-secondary-background--darken-30",g(s,30)),s=r.getPropertyValue("--vscode-button-foreground").trim(),i.setProperty("--color-button-foreground",s);let l=r.getPropertyValue("--vscode-editor-foreground").trim();l||(l=r.getPropertyValue("--vscode-foreground").trim()),i.setProperty("--color-foreground",l),i.setProperty("--color-foreground--85",v(l,85)),i.setProperty("--color-foreground--75",v(l,75)),i.setProperty("--color-foreground--65",v(l,65)),i.setProperty("--color-foreground--50",v(l,50)),s=r.getPropertyValue("--vscode-focusBorder").trim(),i.setProperty("--color-focus-border",s),s=r.getPropertyValue("--vscode-textLink-foreground").trim(),i.setProperty("--color-link-foreground",s),i.setProperty("--color-link-foreground--darken-20",g(s,20)),i.setProperty("--color-link-foreground--lighten-20",h(s,20)),s=r.getPropertyValue("--vscode-sideBar-background").trim(),i.setProperty("--color-view-background",s||c),s=r.getPropertyValue("--vscode-sideBar-foreground").trim(),i.setProperty("--color-view-foreground",s||l),i.setProperty("--color-view-header-foreground",r.getPropertyValue("--vscode-sideBarSectionHeader-foreground").trim()||s||l),s=r.getPropertyValue("--vscode-editorHoverWidget-background").trim(),i.setProperty("--color-hover-background",s),s=r.getPropertyValue("--vscode-editorHoverWidget-border").trim(),i.setProperty("--color-hover-border",s),s=r.getPropertyValue("--vscode-editorHoverWidget-foreground").trim(),i.setProperty("--color-hover-foreground",s),s=r.getPropertyValue("--vscode-editorHoverWidget-statusBarBackground").trim(),i.setProperty("--color-hover-statusBarBackground",s),i.setProperty("--graph-theme-opacity-factor",a?"0.5":"1"),i.setProperty("--color-graph-actionbar-background",a?g(c,5):h(c,5)),i.setProperty("--color-graph-actionbar-selectedBackground",a?g(c,10):h(c,10)),i.setProperty("--color-graph-background",a?g(c,5):h(c,5)),i.setProperty("--color-graph-background2",a?g(c,10):h(c,10)),s=r.getPropertyValue("--vscode-list-focusOutline").trim(),i.setProperty("--color-graph-contrast-border-color",s),s=r.getPropertyValue("--vscode-list-activeSelectionBackground").trim(),i.setProperty("--color-graph-selected-row",s),s=r.getPropertyValue("--vscode-list-hoverBackground").trim(),i.setProperty("--color-graph-hover-row",s),s=r.getPropertyValue("--vscode-list-activeSelectionForeground").trim(),i.setProperty("--color-graph-text-selected-row",s),i.setProperty("--color-graph-text-dimmed-selected",v(s,50)),i.setProperty("--color-graph-text-dimmed",v(l,20)),s=r.getPropertyValue("--vscode-list-hoverForeground").trim(),i.setProperty("--color-graph-text-hovered",s),i.setProperty("--color-graph-text-selected",l),i.setProperty("--color-graph-text-normal",v(l,85)),i.setProperty("--color-graph-text-secondary",v(l,65)),i.setProperty("--color-graph-text-disabled",v(l,50)),s=r.getPropertyValue("--vscode-inputValidation-infoBackground").trim(),i.setProperty("--color-alert-infoHoverBackground",a?g(s,5):h(s,5)),i.setProperty("--color-alert-infoBackground",s),s=r.getPropertyValue("--vscode-inputValidation-warningBackground").trim(),i.setProperty("--color-alert-warningHoverBackground",a?g(s,5):h(s,5)),i.setProperty("--color-alert-warningBackground",s),s=r.getPropertyValue("--vscode-inputValidation-errorBackground").trim(),i.setProperty("--color-alert-errorHoverBackground",a?g(s,5):h(s,5)),i.setProperty("--color-alert-errorBackground",s),s=a?g(c,5):h(c,5),i.setProperty("--color-alert-neutralHoverBackground",a?g(s,5):h(s,5)),i.setProperty("--color-alert-neutralBackground",s),i.setProperty("--color-alert-infoBorder","var(--vscode-inputValidation-infoBorder)"),i.setProperty("--color-alert-warningBorder","var(--vscode-inputValidation-warningBorder)"),i.setProperty("--color-alert-errorBorder","var(--vscode-inputValidation-errorBorder)"),i.setProperty("--color-alert-neutralBorder","var(--vscode-input-foreground)"),i.setProperty("--color-alert-foreground","var(--vscode-input-foreground)"),t!=null&&le.fire()};o();const e=new MutationObserver(o);return e.observe(document.body,{attributeFilter:["class"]}),e}const $t=2**30;let D=0;function ue(){return D===$t?D=1:D++,`webview:${D}`}class It{constructor(e){this.appName=e,this.state=window.bootstrap,window.bootstrap=void 0,this.log(`${this.appName}()`),this._api=acquireVsCodeApi(),this.onThemeUpdated!=null&&Tt(this.onThemeUpdated,this),xt(),requestAnimationFrame(()=>{this.log(`${this.appName}.initializing`);try{this.onInitialize?.(),this.bind(),this.onMessageReceived!=null&&window.addEventListener("message",this.onMessageReceived.bind(this)),this.sendCommand(ke,void 0),this.onInitialized?.()}finally{document.body.classList.contains("preload")&&setTimeout(()=>{document.body.classList.remove("preload")},500)}})}bind(){this.bindDisposables?.forEach(t=>t.dispose()),this.bindDisposables=this.onBind?.(),this.bindDisposables==null&&(this.bindDisposables=[]);const e=pt(t=>{this.sendCommand(Pe,t)},150);this.bindDisposables.push(y.on(document,"focusin",t=>{const n=t.composedPath().some(r=>r.tagName==="INPUT");(this._focused!==!0||this._inputFocused!==n)&&(this._focused=!0,this._inputFocused=n,e({focused:!0,inputFocused:n}))}),y.on(document,"focusout",()=>{(this._focused!==!1||this._inputFocused!==!1)&&(this._focused=!1,this._inputFocused=!1,e({focused:!1,inputFocused:!1}))}))}log(e,...t){}getState(){return this._api.getState()}sendCommand(e,t){const n=ue();this.log(`${this.appName}.sendCommand(${n}): name=${e.method}`),this.postMessage({id:n,method:e.method,params:t})}async sendCommandWithCompletion(e,t,n){const r=ue();this.log(`${this.appName}.sendCommandWithCompletion(${r}): name=${e.method}`);const a=new Promise((i,c)=>{let s;const l=[y.on(window,"message",u=>{A(n,u.data,p=>{u.data.completionId===r&&(l.forEach(m=>m.dispose()),queueMicrotask(()=>i(p)))})}),{dispose:function(){s!=null&&(clearTimeout(s),s=void 0)}}];s=setTimeout(()=>{s=void 0,l.forEach(u=>u.dispose()),c(new Error(`Timed out waiting for completion of ${n.method}`))},6e4)});return this.postMessage({id:r,method:e.method,params:t,completionId:r}),a}setState(e){this.state=e,e!=null&&this._api.setState(e)}postMessage(e){this._api.postMessage(e)}}const de=new Date().getTimezoneOffset()/60*100,fe=new Date(`Wed Jul 25 2018 19:18:00 GMT${de>=0?"-":"+"}${String(Math.abs(de)).padStart(4,"0")}`);class Ct extends It{constructor(e){super(e),this._changes=Object.create(null),this._updating=!1}onInitialized(){this.updateState()}onBind(){const e=super.onBind?.()??[];return e.push(y.on("input[type=checkbox][data-setting]","change",(t,n)=>this.onInputChecked(n)),y.on("input[type=text][data-setting], input[type=number][data-setting], input:not([type])[data-setting]","blur",(t,n)=>this.onInputBlurred(n)),y.on("input[type=text][data-setting], input[type=number][data-setting], input:not([type])[data-setting]","focus",(t,n)=>this.onInputFocused(n)),y.on("input[type=text][data-setting][data-setting-preview], input[type=number][data-setting][data-setting-preview]","input",(t,n)=>this.onInputChanged(n)),y.on("button[data-setting-clear]","click",(t,n)=>this.onButtonClicked(n)),y.on("select[data-setting]","change",(t,n)=>this.onInputSelected(n)),y.on(".token[data-token]","mousedown",(t,n)=>this.onTokenMouseDown(n,t))),e}onMessageReceived(e){const t=e.data;switch(this.log(`${this.appName}.onMessageReceived(${t.id}): name=${t.method}`),t.method){case Q.method:{A(Q,t,n=>{this.scrollToAnchor(n.anchor,n.scrollBehavior)});break}case G.method:A(G,t,n=>{this.state.config=n.config,this.state.customSettings=n.customSettings,this.updateState()});break;default:super.onMessageReceived?.(e)}}applyChanges(){this.sendCommand(we,{changes:{...this._changes},removes:Object.keys(this._changes).filter(e=>this._changes[e]===void 0),scope:this.getSettingsScope()}),this._changes=Object.create(null)}getSettingsScope(){return"user"}onInputBlurred(e){this.log(`${this.appName}.onInputBlurred: name=${e.name}, value=${e.value}`);const t=document.getElementById(`${e.name}.popup`);t?.classList.add("hidden");let n=e.value;if((n==null||n.length===0)&&(n=e.dataset.defaultValue,n===void 0&&(n=null)),e.dataset.settingType==="arrayObject"){const r=e.name.split("."),a=r[0],i=parseInt(r[1],10),c=r.slice(2);let s=this.getSettingValue(a);if(n==null&&(s===void 0||s?.length===0))s!==void 0&&(this._changes[a]=void 0);else{s=s??[];let l=s[i];(n!=null||n==null&&l!==void 0)&&(l===void 0&&(l=Object.create(null),s[i]=l),C(l,c.join("."),e.type==="number"&&n!=null?Number(n):n),this._changes[a]=s)}}else this._changes[e.name]=e.type==="number"&&n!=null?Number(n):n;this.applyChanges()}onButtonClicked(e){if(e.dataset.settingType==="arrayObject"){const t=e.name.split("."),n=t[0],r=this.getSettingValue(n);if(r===void 0)return;const a=parseInt(t[1],10);if(r[a]==null)return;r.splice(a,1),this._changes[n]=r.length?r:void 0,this.applyChanges()}}onInputChanged(e){if(!this._updating)for(const t of document.querySelectorAll(`span[data-setting-preview="${e.name}"]`))this.updatePreview(t,e.value)}onInputChecked(e){if(!this._updating){switch(this.log(`${this.appName}.onInputChecked: name=${e.name}, checked=${e.checked}, value=${e.value}`),e.dataset.settingType){case"object":{const t=e.name.split("."),n=t.splice(0,1)[0],r=this.getSettingValue(n)??Object.create(null);e.checked?C(r,t.join("."),z(e.value)):C(r,t.join("."),!1),this._changes[n]=r;break}case"array":{const t=this.getSettingValue(e.name)??[];if(Array.isArray(t)){if(e.checked)t.includes(e.value)||t.push(e.value);else{const n=t.indexOf(e.value);n!==-1&&t.splice(n,1)}this._changes[e.name]=t}break}case"arrayObject":{const t=e.name.split("."),n=t[0],r=parseInt(t[1],10),a=t.slice(2),i=this.getSettingValue(n)??[],c=i[r]??Object.create(null);i[r]===void 0&&(i[r]=c),e.checked?C(i[r],a.join("."),z(e.value)):C(i[r],a.join("."),!1),this._changes[n]=i;break}case"custom":{this._changes[e.name]=e.checked;break}default:{e.checked?this._changes[e.name]=z(e.value):this._changes[e.name]=e.dataset.valueOff==null?!1:e.dataset.valueOff;break}}this.setAdditionalSettings(e.checked?e.dataset.addSettingsOn:e.dataset.addSettingsOff),this.applyChanges()}}onInputFocused(e){this.log(`${this.appName}.onInputFocused: name=${e.name}, value=${e.value}`);const t=document.getElementById(`${e.name}.popup`);if(t!=null){if(t.childElementCount===0){const n=document.querySelector("#token-popup")?.content.cloneNode(!0);n!=null&&t.appendChild(n)}t.classList.remove("hidden")}}onInputSelected(e){if(this._updating)return;const t=e.options[e.selectedIndex].value;this.log(`${this.appName}.onInputSelected: name=${e.name}, value=${t}`),this._changes[e.name]=ge(t),this.applyChanges()}onTokenMouseDown(e,t){if(this._updating)return;this.log(`${this.appName}.onTokenClicked: id=${e.id}`);const n=e.closest(".setting");if(n==null)return;const r=n.querySelector("input[type=text], input:not([type])");if(r==null)return;const a=`\${${e.dataset.token}}`;let i=r.selectionStart;i!=null?(r.value=`${r.value.substring(0,i)}${a}${r.value.substr(r.selectionEnd??i)}`,i+=a.length):i=r.value.length,r.focus(),r.setSelectionRange(i,i),i===r.value.length&&(r.scrollLeft=r.scrollWidth),setTimeout(()=>this.onInputChanged(r),0),setTimeout(()=>r.focus(),250),t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault()}scrollToAnchor(e,t,n){const r=document.getElementById(e);r!=null&&this.scrollTo(r,t,n)}scrollTo(e,t,n){const r=e.getBoundingClientRect().top-document.body.getBoundingClientRect().top-(n??0);window.scrollTo({top:r,behavior:t??"smooth"});const a=()=>{this._scrollTimer!=null&&clearTimeout(this._scrollTimer),this._scrollTimer=setTimeout(()=>{window.removeEventListener("scroll",a);const i=e.getBoundingClientRect().top-document.body.getBoundingClientRect().top-(n??0);r!==i&&this.scrollTo(e,t,n)},50)};window.addEventListener("scroll",a,!1)}evaluateStateExpression(e,t){let n=!1;for(const r of e.trim().split("&")){const[a,i,c]=jt(r);switch(i){case"=":{let s=t[a];s===void 0&&(s=this.getSettingValue(a)??!1),n=c!==void 0?c===String(s):Boolean(s);break}case"!":{let s=t[a];s===void 0&&(s=this.getSettingValue(a)??!1),n=c!==void 0?c!==String(s):!s;break}case"+":{if(c!==void 0){const s=this.getSettingValue(a);n=s!==void 0?s.includes(c.toString()):!1}break}}if(!n)break}return n}getCustomSettingValue(e){return this.state.customSettings?.[e]}getSettingValue(e){const t=this.getCustomSettingValue(e);return t??Vt(this.state.config,e)}updateState(){this.beforeUpdateState?.(),this._updating=!0,xe(this.state.config.defaultDateLocale);try{for(const t of document.querySelectorAll("input[type=checkbox][data-setting]"))if(t.dataset.settingType==="custom")t.checked=this.getCustomSettingValue(t.name)??!1;else if(t.dataset.settingType==="array")t.checked=(this.getSettingValue(t.name)??[]).includes(t.value);else if(t.dataset.valueOff!=null){const n=this.getSettingValue(t.name);t.checked=t.dataset.valueOff!==n}else t.checked=this.getSettingValue(t.name)??!1;for(const t of document.querySelectorAll("input[type=text][data-setting], input[type=number][data-setting], input:not([type])[data-setting]"))t.value=this.getSettingValue(t.name)??"";for(const t of document.querySelectorAll("select[data-setting]")){const n=this.getSettingValue(t.name),r=t.querySelector(`option[value='${n}']`);r!=null&&(r.selected=!0)}for(const t of document.querySelectorAll("span[data-setting-preview]"))this.updatePreview(t)}finally{this._updating=!1}const e=pe(this.state.config);if(this.state.customSettings!=null)for(const[t,n]of Object.entries(this.state.customSettings))e[t]=n;this.setVisibility(e),this.setEnablement(e)}setAdditionalSettings(e){if(!e)return;const t=Bt(e);for(const[n,r]of t)this._changes[n]=r}setEnablement(e){for(const t of document.querySelectorAll("[data-enablement]")){const n=!this.evaluateStateExpression(t.dataset.enablement,e);if(n?t.setAttribute("disabled",""):t.removeAttribute("disabled"),t.matches("input,select"))t.disabled=n;else{const r=t.querySelector("input,select");if(r==null)continue;r.disabled=n}}}setVisibility(e){for(const t of document.querySelectorAll("[data-visibility]"))t.classList.toggle("hidden",!this.evaluateStateExpression(t.dataset.visibility,e))}updatePreview(e,t){const n=e.dataset.settingPreviewType;switch(n){case"date":{if(t===void 0&&(t=this.getSettingValue(e.dataset.settingPreview)),!t&&(t=e.dataset.settingPreviewDefault,t==null)){const r=e.dataset.settingPreviewDefaultLookup;r!=null&&(t=this.getSettingValue(r))}e.innerText=t==null?"":X(fe,t,void 0,!1);break}case"date-locale":{t===void 0&&(t=this.getSettingValue(e.dataset.settingPreview)),t||(t=void 0);const r=this.getSettingValue(e.dataset.settingPreviewDefault)??"MMMM Do, YYYY h:mma";try{e.innerText=X(fe,r,t,!1)}catch(a){e.innerText=a.message}break}case"commit":case"commit-uncommitted":{if(t===void 0&&(t=this.getSettingValue(e.dataset.settingPreview)),!t&&(t=e.dataset.settingPreviewDefault,t==null)){const r=e.dataset.settingPreviewDefaultLookup;r!=null&&(t=this.getSettingValue(r))}if(t==null){e.innerText="";return}this.sendCommandWithCompletion(_e,{key:e.dataset.settingPreview,type:n,format:t},Se).then(r=>{e.innerText=r.preview??""});break}default:break}}}function ge(o){return o==="true"?!0:o==="false"?!1:o==="null"?null:o}function Vt(o,e){return e.split(".").reduce((t={},n)=>t?.[n],o)}function C(o,e,t){const n=e.split("."),r=n.length,a=r-1;let i=-1,c=o;for(;c!=null&&++i<r;){const s=n[i];let l=t;if(i!==a){const u=c[s];l=typeof u=="object"?u:{}}c[s]=l,c=c[s]}return o}function Bt(o){return o.trim().split(",").map(t=>{const[n,r]=t.split("=");return[n,ge(r)]})}function jt(o){const[e,t,n]=o.trim().split(/([=+!])/);return[e.trim(),t!==void 0?t.trim():"=",n!==void 0?n.trim():n]}function pe(o,e){const t={};for(const n in o){const r=o[n];Array.isArray(r)||(typeof r=="object"?Object.assign(t,pe(r,e===void 0?n:`${e}.${n}`)):t[e===void 0?n:`${e}.${n}`]=r)}return t}function z(o){switch(o){case"on":return!0;case"null":return null;case"undefined":return;default:return o}}class Ot extends Ct{constructor(){super("WelcomeApp")}}new Ot})();
